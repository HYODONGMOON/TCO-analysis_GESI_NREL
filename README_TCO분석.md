# TCO (Total Cost of Ownership) 분석 모델

## 개요
이 모델은 ICE(내연기관차)와 BEV(전기차)의 총소유비용을 비교하고, ICE에 대한 직간접 지원 제거 시 소비자 선택 변화를 분석하는 도구입니다.

## 주요 기능
- **차량 분류별 TCO 분석**: 승용/승합/화물 → 자가/상용 → 소형/중형/대형
- **ICE vs BEV 비용 비교**: 구매비용, 연료비, 유지보수비, 세금/보험, 감가상각, 보조금
- **시나리오 분석**: ICE 지원 제거 시 경쟁력 변화
- **소비자 선택 모델**: 로지스틱 회귀를 통한 선택 확률 예측
- **시각화**: 분석 결과의 그래프 및 차트

## 파일 구조
```
📁 TCO 분석 모델/
├── 📄 create_tco_template.py      # 엑셀 템플릿 생성 스크립트
├── 📄 tco_analysis.py             # 메인 분석 코드
├── 📊 TCO_분석_입력템플릿.xlsx     # 입력 데이터 템플릿
├── 📈 TCO_분석_결과.png           # 분석 결과 시각화
└── 📄 README_TCO분석.md           # 이 파일
```

## 사용 방법

### 1. 필요 패키지 설치
```bash
pip install pandas openpyxl scikit-learn matplotlib seaborn numpy
```

### 2. 엑셀 템플릿 생성 (선택사항)
```bash
python create_tco_template.py
```
- `TCO_분석_입력템플릿.xlsx` 파일이 생성됩니다.
- 예시 데이터가 포함되어 있어 바로 분석이 가능합니다.

### 3. 데이터 입력 (실제 데이터 사용 시)
생성된 엑셀 파일에서 다음 시트를 수정:
- **차량분류 시트**: 기본 차량 데이터
- **지원제거시나리오 시트**: ICE 지원 제거 시나리오

### 4. TCO 분석 실행
```bash
python tco_analysis.py
```

## 엑셀 템플릿 구조

### 차량분류 시트
| 항목 | 설명 |
|------|------|
| 대분류 | 승용/승합/화물 |
| 중분류 | 자가/상용 |
| 소분류 | 소형/중형/대형 |
| 차량유형 | ICE/BEV |
| 차량대수 | 해당 분류의 차량 대수 |
| 구매비용_만원 | 차량 구매 비용 |
| 연료비_만원 | 연간 연료비 또는 전기비 |
| 유지보수비_만원 | 연간 유지보수비 |
| 세금보험_만원 | 연간 세금 및 보험료 |
| 감가상각_만원 | 연간 감가상각비 |
| 보조금_만원 | 정부 보조금 (차감) |
| 기타비용_만원 | 기타 운영비용 |

### 지원제거시나리오 시트
- 기본 데이터 + ICE에 대한 숨겨진 지원(연료세 감면 등) 제거 시나리오

## 분석 결과

### 1. 기본 TCO 분석
- 차량유형별 평균 TCO 비교
- 분류별 세부 TCO 분석
- 비용 구성요소별 비교

### 2. 시나리오 분석
- ICE 지원 제거 전후 TCO 변화
- BEV 경쟁력 개선 효과

### 3. 소비자 선택 모델
- 로지스틱 회귀 모델을 통한 BEV 선택 확률 예측
- 특성 중요도 분석
- TCO 변화에 따른 선택 확률 변화

### 4. 시각화
- 차량유형별 평균 TCO 바차트
- 비용 구성요소 비교 차트
- 시나리오 분석 결과
- TCO 차이에 따른 BEV 선택 확률 곡선

## 주요 분석 결과 예시

```
📊 현재 상황:
   • ICE 평균 TCO: 7,407만원
   • BEV 평균 TCO: 7,898만원
   • BEV가 ICE보다 492만원 비쌈

🔄 ICE 지원 제거 시:
   • ICE TCO 증가: 123만원
   • BEV 경쟁력 개선: 123만원

🎯 소비자 선택 요인:
   • 가장 중요한 요인: 구매비용
   • 총소유비용이 핵심적 영향

💡 정책 시사점:
   • ICE 직간접 지원 제거 시 BEV 경쟁력 향상
   • 차량 분류별 맞춤형 정책 필요
```

## 코드 구조

### TCOAnalyzer 클래스
- `load_data()`: 엑셀 데이터 로드
- `basic_analysis()`: 기본 TCO 분석
- `scenario_analysis()`: 시나리오 분석
- `choice_model_analysis()`: 소비자 선택 모델
- `visualize_results()`: 결과 시각화
- `generate_report()`: 분석 리포트 생성
- `run_full_analysis()`: 전체 분석 실행

## 확장 가능성
1. **더 많은 차량 분류**: 연료 타입, 브랜드별 세분화
2. **동적 가격 모델**: 시간에 따른 가격 변화 반영
3. **정책 시뮬레이션**: 다양한 정책 시나리오 테스트
4. **지역별 분석**: 지역별 특성을 고려한 TCO 분석
5. **환경 비용**: 탄소세, 환경 비용 등 반영

## 문의 및 개선사항
- 버그 리포트나 개선사항이 있으면 이슈로 등록해 주세요.
- 새로운 기능 제안도 환영합니다.

---
**개발일**: 2025-06-19  
**버전**: 1.0  
**라이선스**: MIT 